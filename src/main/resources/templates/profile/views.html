<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö—Ç–æ –ø–æ—Å–µ—â–∞–ª –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å</title>
</head>
<body>
<div class="container">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
    <div class="page-header">
        <h1>–ö—Ç–æ –ø–æ—Å–µ—â–∞–ª –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å</h1>
        <p>–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ, –∫—Ç–æ –∑–∞—Ö–æ–¥–∏–ª –Ω–∞ –≤–∞—à—É —Å—Ç—Ä–∞–Ω–∏—Ü—É</p>
    </div>

    <!-- –°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö -->
    <div th:if="${errorMessage}" class="error-message">
        <p th:text="${errorMessage}"></p>
    </div>

    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
    <div class="stats-section">
        <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤</h2>
        <div class="stats-grid">
            <div class="stat-item">
                <span class="stat-number" th:text="${visitStats.totalVisits}">0</span>
                <span class="stat-label">–í—Å–µ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" th:text="${visitStats.todayVisits}">0</span>
                <span class="stat-label">–°–µ–≥–æ–¥–Ω—è</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" th:text="${visitStats.weekVisits}">0</span>
                <span class="stat-label">–ó–∞ –Ω–µ–¥–µ–ª—é</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" th:text="${visitStats.monthVisits}">0</span>
                <span class="stat-label">–ó–∞ –º–µ—Å—è—Ü</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" th:text="${visitStats.uniqueVisitorsCount}">0</span>
                <span class="stat-label">–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π</span>
            </div>
        </div>
    </div>

    <!-- –§–∏–ª—å—Ç—Ä –ø–æ –ø–µ—Ä–∏–æ–¥—É -->
    <div class="filter-section">
        <h3>–ü–µ—Ä–∏–æ–¥ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞:</h3>
        <form method="get" action="/views">
            <select name="days" onchange="this.form.submit()">
                <option th:each="period : ${periodOptions}"
                        th:value="${period.key}"
                        th:text="${period.value}"
                        th:selected="${period.key == selectedDays}">
                </option>
            </select>
        </form>
    </div>

    <!-- –°–ø–∏—Å–æ–∫ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π -->
    <div class="visitors-section">
        <h2>
            –ü–æ—Å–µ—Ç–∏—Ç–µ–ª–∏
            <span th:if="${selectedDays == 1}">–∑–∞ —Å–µ–≥–æ–¥–Ω—è</span>
            <span th:if="${selectedDays == 7}">–∑–∞ –Ω–µ–¥–µ–ª—é</span>
            <span th:if="${selectedDays == 30}">–∑–∞ –º–µ—Å—è—Ü</span>
            <span th:if="${selectedDays == 90}">–∑–∞ 3 –º–µ—Å—è—Ü–∞</span>
            <span th:if="${selectedDays == 365}">–∑–∞ –≥–æ–¥</span>
            <span th:if="${selectedDays != 1 and selectedDays != 7 and selectedDays != 30 and selectedDays != 90 and selectedDays != 365}">
                    –∑–∞ [[${selectedDays}]] –¥–Ω–µ–π
                </span>
        </h2>

        <!-- –ï—Å–ª–∏ –Ω–µ—Ç –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π -->
        <div th:if="${visitors == null or #lists.isEmpty(visitors)}" class="no-visitors">
            <p>–ó–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –Ω–∏–∫—Ç–æ –Ω–µ –ø–æ—Å–µ—â–∞–ª –≤–∞—à –ø—Ä–æ—Ñ–∏–ª—å</p>
            <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ:</p>
            <ul>
                <li>–£–≤–µ–ª–∏—á–∏—Ç—å –ø–µ—Ä–∏–æ–¥ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞</li>
                <li>–î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ —Å–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å</li>
                <li>–ë—ã—Ç—å –±–æ–ª–µ–µ –∞–∫—Ç–∏–≤–Ω—ã–º –≤ —Å–æ–æ–±—â–µ—Å—Ç–≤–µ</li>
            </ul>
        </div>

        <!-- –°–ø–∏—Å–æ–∫ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π -->
        <div th:if="${visitors != null and !#lists.isEmpty(visitors)}" class="visitors-list">
            <div th:each="visitor : ${visitors}" class="visitor-card">
                <div class="visitor-avatar">
                    <a th:href="@{/profile/{userId}(userId=${visitor.visitorId})}">
                        <img th:if="${visitor.visitorImageUrl}"
                             th:src="${visitor.visitorImageUrl}"
                             th:alt="${visitor.getVisitorFirstName() + ' ' + visitor.getVisitorLastName()}"
                             width="50" height="50">
                        <div th:unless="${visitor.visitorImageUrl}" class="default-avatar">
                            üë§
                        </div>
                    </a>
                    <div th:if="${visitor.visitorIsOnline}" class="online-indicator">üü¢</div>
                </div>

                <div class="visitor-info">
                    <div class="visitor-name">
                        <a th:href="@{/profile/{userId}(userId=${visitor.visitorId})}" th:text="${visitor.getVisitorFirstName() + ' ' + visitor.getVisitorLastName()}">
                            –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                        </a>
                    </div>

                    <div class="visitor-details">
                        <div th:if="${visitor.visitorCity}" class="visitor-location">
                            üìç <span th:text="${visitor.visitorCity}">–ì–æ—Ä–æ–¥</span>
                        </div>

                        <div class="visitor-date" th:if="${visitor.visitedAt}">
                            üïí –ó–∞—Ö–æ–¥–∏–ª:
                            <span th:text="${#temporals.format(visitor.visitedAt, 'dd.MM.yyyy HH:mm')}">–¥–∞—Ç–∞</span>
                        </div>
                    </div>
                </div>

                <div class="visitor-actions">
                    <a th:href="@{/profile/{userId}(userId=${visitor.visitorId})}" class="btn-view-profile">
                        –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
                    </a>
                    <button class="btn-send-message"
                            th:onclick="'sendMessage(' + ${visitor.visitorId} + ')'"
                            th:if="${visitor.visitorId != currentUser.id}">
                        –ù–∞–ø–∏—Å–∞—Ç—å
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π –±–ª–æ–∫ -->
    <div class="info-section">
        <h3>‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
        <ul>
            <li>–ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</li>
            <li>–ö–∞–∂–¥—ã–π –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥</li>
            <li>–í–∞—à–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ—Å–µ—â–µ–Ω–∏—è –Ω–µ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è</li>
            <li>–î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</li>
        </ul>
    </div>


</div>

<script>

    // –ü–æ–∫–∞–∑–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ
    document.addEventListener('DOMContentLoaded', function() {
        const visitorsCount = document.querySelectorAll('.visitor-card').length;
        if (visitorsCount > 0) {
            const header = document.querySelector('.visitors-section h2');
            header.innerHTML = header.innerHTML + ' (' + visitorsCount + ')';
        }
    });
</script>
</body>
</html>