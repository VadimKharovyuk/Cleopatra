<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∞–º–∏ - –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</title>
</head>
<body>
<div>
  <header>
    <h1>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∞–º–∏ –Ω–∞ —Ä–∞–±–æ—Ç—É</h1>
    <nav>
      <a href="/admin">–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</a> |
      <a href="/job/create">–ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞</a> |
      <a href="/admin/job-applications">–í—Å–µ –∑–∞—è–≤–∫–∏</a>
    </nav>
  </header>

  <!-- –§–∏–ª—å—Ç—Ä—ã –∏ –ø–æ–∏—Å–∫ -->
  <section>
    <h3>–§–∏–ª—å—Ç—Ä—ã –∏ –ø–æ–∏—Å–∫</h3>
    <form method="get" action="/admin/job-applications">
      <div style="display: flex; gap: 10px; flex-wrap: wrap; align-items: end;">

        <!-- –ü–æ–∏—Å–∫ -->
        <div>
          <label for="search">–ü–æ–∏—Å–∫:</label><br>
          <input type="text" id="search" name="search"
                 th:value="${searchQuery}"
                 placeholder="–ò–º—è –∏–ª–∏ email">
        </div>

        <!-- –°—Ç–∞—Ç—É—Å -->
        <div>
          <label for="status">–°—Ç–∞—Ç—É—Å:</label><br>
          <select id="status" name="status">
            <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
            <option th:each="status : ${allStatuses}"
                    th:value="${status}"
                    th:text="${status.name()}"
                    th:selected="${status == selectedStatus}"></option>
          </select>
        </div>

        <!-- –ü—Ä–æ—Ñ–∏–ª—å -->
        <div>
          <label for="profile">–ü—Ä–æ—Ñ–∏–ª—å:</label><br>
          <select id="profile" name="profile">
            <option value="">–í—Å–µ –ø—Ä–æ—Ñ–∏–ª–∏</option>
            <option th:each="profile : ${allProfiles}"
                    th:value="${profile}"
                    th:text="${profile.name()}"
                    th:selected="${profile == selectedProfile}"></option>
          </select>
        </div>

        <!-- –°—Ç—Ä–∞–Ω–∞ -->
        <div>
          <label for="country">–°—Ç—Ä–∞–Ω–∞:</label><br>
          <input type="text" id="country" name="country"
                 th:value="${selectedCountry}"
                 placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω—ã">
        </div>

        <!-- –†–∞–∑–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
        <!-- –ó–∞–º–µ–Ω–∏—Ç—å currentSize –Ω–∞ applicationsDto.itemsPerPage -->
        <div>
          <label for="size">–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ:</label><br>
          <select id="size" name="size">
            <option value="10" th:selected="${applicationsDto.itemsPerPage == 10}">10</option>
            <option value="25" th:selected="${applicationsDto.itemsPerPage == 25}">25</option>
            <option value="50" th:selected="${applicationsDto.itemsPerPage == 50}">50</option>
          </select>
        </div>

        <!-- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ -->
        <div>
          <label for="sortBy">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:</label><br>
          <select id="sortBy" name="sortBy">
            <option value="createdAt" th:selected="${currentSortBy == 'createdAt'}">–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è</option>
            <option value="name" th:selected="${currentSortBy == 'name'}">–ò–º—è</option>
            <option value="age" th:selected="${currentSortBy == 'age'}">–í–æ–∑—Ä–∞—Å—Ç</option>
            <option value="workExperience" th:selected="${currentSortBy == 'workExperience'}">–û–ø—ã—Ç</option>
            <option value="minSalary" th:selected="${currentSortBy == 'minSalary'}">–ó–∞—Ä–ø–ª–∞—Ç–∞</option>
          </select>
        </div>

        <div>
          <label for="sortDir">–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:</label><br>
          <select id="sortDir" name="sortDir">
            <option value="asc" th:selected="${currentSortDir == 'asc'}">–ü–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é</option>
            <option value="desc" th:selected="${currentSortDir == 'desc'}">–ü–æ —É–±—ã–≤–∞–Ω–∏—é</option>
          </select>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∏ -->
        <div>
          <button type="submit">–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</button>
          <a href="/admin/job-applications" style="margin-left: 10px;">–°–±—Ä–æ—Å–∏—Ç—å</a>
        </div>
      </div>
    </form>
  </section>

  <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö -->
  <section style="margin: 20px 0;">
    <p>
      <strong>–ù–∞–π–¥–µ–Ω–æ:</strong> <span th:text="${applicationsDto.totalItems}">0</span> –∑–∞—è–≤–æ–∫ |
      <strong>–°—Ç—Ä–∞–Ω–∏—Ü–∞:</strong> <span th:text="${applicationsDto.currentPage + 1}">1</span>
      –∏–∑ <span th:text="${applicationsDto.totalPages}">1</span> |
      <strong>–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ:</strong> <span th:text="${applicationsDto.itemsPerPage}">10</span>
    </p>
  </section>

  <!-- –¢–∞–±–ª–∏—Ü–∞ –∑–∞—è–≤–æ–∫ -->
  <section>
    <div style="overflow-x: auto;">
      <table border="1" style="width: 100%; border-collapse: collapse;">
        <thead style="background-color: #f0f0f0;">
        <tr>
          <th style="padding: 10px; text-align: left;">ID</th>
          <th style="padding: 10px; text-align: left;">–ò–º—è</th>
          <th style="padding: 10px; text-align: left;">–ü—Ä–æ—Ñ–∏–ª—å</th>
          <th style="padding: 10px; text-align: left;">–û–ø—ã—Ç (–ª–µ—Ç)</th>
          <th style="padding: 10px; text-align: left;">–ú–∏–Ω. –∑–∞—Ä–ø–ª–∞—Ç–∞</th>
          <th style="padding: 10px; text-align: left;">–í–æ–∑—Ä–∞—Å—Ç</th>
          <th style="padding: 10px; text-align: left;">–î–µ–π—Å—Ç–≤–∏—è</th>
        </tr>
        </thead>
        <tbody>
        <!-- –°—Ç—Ä–æ–∫–∏ –∑–∞—è–≤–æ–∫ -->
        <tr th:each="jobApp, iterStat : ${applicationsDto.applications}"
            th:style="${iterStat.even} ? 'background-color: #fafafa;' : ''">

          <td style="padding: 8px;" th:text="${jobApp.id}">1</td>

          <td style="padding: 8px;">
            <strong th:text="${jobApp.name}">–ò–º—è</strong>
          </td>

          <td style="padding: 8px;">
                                <span th:if="${jobApp.profile != null}"
                                      th:text="${jobApp.profile.name()}"
                                      style="background-color: #e3f2fd; padding: 2px 6px; border-radius: 3px; font-size: 12px;">
                                    –ü—Ä–æ—Ñ–∏–ª—å
                                </span>
            <span th:unless="${jobApp.profile != null}">-</span>
          </td>

          <td style="padding: 8px;" th:text="${jobApp.workExperience ?: '-'}">5</td>

          <td style="padding: 8px;">
                                <span th:if="${jobApp.minSalary != null}"
                                      th:text="${jobApp.minSalary}">1000</span>
            <span th:unless="${jobApp.minSalary != null}">-</span>
          </td>

          <td style="padding: 8px;" th:text="${jobApp.age ?: '-'}">25</td>

          <td style="padding: 8px;">
            <a th:href="@{/admin/job-applications/view(id=${jobApp.id})}"
               style="color: #2196f3; text-decoration: none; margin-right: 5px;">
              üëÅ –ü—Ä–æ—Å–º–æ—Ç—Ä
            </a>
            <a th:href="@{/admin/job-applications/edit(id=${jobApp.id})}"
               style="color: #ff9800; text-decoration: none; margin-right: 5px;">
              ‚úè –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
            </a>
            <a href="#"
               style="color: #f44336; text-decoration: none;"
               onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –∑–∞—è–≤–∫—É?')">
              üóë –£–¥–∞–ª–∏—Ç—å
            </a>
          </td>
        </tr>

        <!-- –ï—Å–ª–∏ –Ω–µ—Ç –∑–∞—è–≤–æ–∫ -->
        <tr th:if="${applicationsDto.applications.empty}">
          <td colspan="7" style="padding: 20px; text-align: center; color: #666;">
            –ó–∞—è–≤–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </section>

  <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
  <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
  <section th:if="${applicationsDto.totalPages > 1}" style="margin: 20px 0; text-align: center;">

    <!-- –ü—Ä–µ–¥—ã–¥—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
    <a th:if="${applicationsDto.hasPrevious}"
       th:href="@{/admin/job-applications(page=${applicationsDto.previousPage}, size=${applicationsDto.itemsPerPage}, sortBy=${currentSortBy}, sortDir=${currentSortDir}, status=${selectedStatus}, profile=${selectedProfile}, country=${selectedCountry}, search=${searchQuery})}"
       style="padding: 8px 12px; margin: 0 2px; background-color: #f5f5f5; text-decoration: none; border-radius: 4px;">
      ¬´ –ü—Ä–µ–¥—ã–¥—É—â–∞—è
    </a>

    <!-- –ù–æ–º–µ—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü (–æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å) -->
    <span th:each="pageNum : ${#numbers.sequence(0, applicationsDto.totalPages - 1)}">
    <span th:if="${pageNum == applicationsDto.currentPage}"
          style="padding: 8px 12px; margin: 0 2px; background-color: #2196f3; color: white; border-radius: 4px;"
          th:text="${pageNum + 1}">1</span>

    <a th:unless="${pageNum == applicationsDto.currentPage}"
       th:href="@{/admin/job-applications(page=${pageNum}, size=${applicationsDto.itemsPerPage}, sortBy=${currentSortBy}, sortDir=${currentSortDir}, status=${selectedStatus}, profile=${selectedProfile}, country=${selectedCountry}, search=${searchQuery})}"
       style="padding: 8px 12px; margin: 0 2px; background-color: #f5f5f5; text-decoration: none; border-radius: 4px;"
       th:text="${pageNum + 1}">2</a>
  </span>

    <!-- –°–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
    <a th:if="${applicationsDto.hasNext}"
       th:href="@{/admin/job-applications(page=${applicationsDto.nextPage}, size=${applicationsDto.itemsPerPage}, sortBy=${currentSortBy}, sortDir=${currentSortDir}, status=${selectedStatus}, profile=${selectedProfile}, country=${selectedCountry}, search=${searchQuery})}"
       style="padding: 8px 12px; margin: 0 2px; background-color: #f5f5f5; text-decoration: none; border-radius: 4px;">
      –°–ª–µ–¥—É—é—â–∞—è ¬ª
    </a>
  </section>

  <footer style="margin-top: 40px; border-top: 1px solid #ddd; padding-top: 20px;">
    <p style="text-align: center; color: #666;">
      ¬© 2025 Cleopatra Admin Panel
    </p>
  </footer>
</div>
</body>
</html>