<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è - –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</title>
</head>
<body>
<h1>–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h1>

<nav>
  <a href="/admin/users/search">–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</a> |
  <a href="/admin/users/blocked">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</a> |
  <a href="/dashboard">–ì–ª–∞–≤–Ω–∞—è</a>
</nav>

<hr>

<!-- –°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö -->
<div th:if="${error}" style="color: red; border: 1px solid red; padding: 10px; margin: 10px 0;">
  <strong>–û—à–∏–±–∫–∞:</strong> <span th:text="${error}"></span>
</div>

<!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ -->
<div th:if="${user}">
  <h2>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ</h2>

  <table border="1" cellpadding="10" cellspacing="0" style="margin-bottom: 20px;">
    <tr>
      <th style="background-color: #f5f5f5; text-align: left;">ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</th>
      <td th:text="${user.id}"></td>
    </tr>
    <tr>
      <th style="background-color: #f5f5f5; text-align: left;">Email</th>
      <td th:text="${user.email}"></td>
    </tr>
    <tr>
      <th style="background-color: #f5f5f5; text-align: left;">–ò–º—è</th>
      <td th:text="${user.firstName}"></td>
    </tr>
    <tr>
      <th style="background-color: #f5f5f5; text-align: left;">–§–∞–º–∏–ª–∏—è</th>
      <td th:text="${user.lastName}"></td>
    </tr>
    <tr>
      <th style="background-color: #f5f5f5; text-align: left;">–ü—Ä–∏–≤–∞—Ç–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å</th>
      <td>
        <span th:if="${user.isPrivateProfile}" style="color: orange;">–î–∞</span>
        <span th:unless="${user.isPrivateProfile}" style="color: green;">–ù–µ—Ç</span>
      </td>
    </tr>
    <tr>
      <th style="background-color: #f5f5f5; text-align: left;">–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å</th>
      <td>
        <span th:if="${user.isBlocked}" style="color: red; font-weight: bold;">–ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù</span>
        <span th:unless="${user.isBlocked}" style="color: green; font-weight: bold;">–ê–ö–¢–ò–í–ï–ù</span>
      </td>
    </tr>
  </table>

  <!-- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω -->
  <div th:if="${user.isBlocked}" style="color: red; border: 2px solid red; padding: 15px; margin: 20px 0;">
    <h3>‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï!</h3>
    <p><strong>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω!</strong></p>
    <p>–î–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏.</p>

    <div style="margin-top: 15px;">
      <a href="/admin/users/blocked" style="text-decoration: none;">
        <button style="background-color: green; color: white; padding: 10px 20px;">
          –ü–µ—Ä–µ–π—Ç–∏ –∫ —Å–ø–∏—Å–∫—É –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö
        </button>
      </a>

      <a th:href="@{'/admin/users/' + ${user.id} + '/history'}" style="text-decoration: none; margin-left: 10px;">
        <button style="background-color: blue; color: white; padding: 10px 20px;">
          –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å—Ç–æ—Ä–∏—é
        </button>
      </a>
    </div>
  </div>

  <!-- –§–æ—Ä–º–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω) -->
  <div th:unless="${user.isBlocked}">
    <h2 style="color: red;">üö´ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>

    <div style="border: 2px solid red; padding: 20px; margin: 20px 0;">
      <h3>‚ö†Ô∏è –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏</h3>
      <p><strong>–í—ã —Å–æ–±–∏—Ä–∞–µ—Ç–µ—Å—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</strong></p>
      <ul>
        <li><strong>ID:</strong> <span th:text="${user.id}"></span></li>
        <li><strong>Email:</strong> <span th:text="${user.email}"></span></li>
        <li><strong>–ò–º—è:</strong> <span th:text="${user.firstName + ' ' + user.lastName}"></span></li>
      </ul>

      <p style="color: red; font-weight: bold;">
        –ü–æ—Å–ª–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —Å–º–æ–∂–µ—Ç –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É!
      </p>

      <form th:action="@{'/admin/users/' + ${user.id} + '/block'}" method="post" onsubmit="return confirmBlock()">
        <h4>–ü—Ä–∏—á–∏–Ω–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:</h4>
        <select id="reasonSelect" onchange="handleReasonChange()" style="width: 100%; padding: 5px; margin-bottom: 10px;">
          <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É --</option>
          <option value="–ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª —Å–æ–æ–±—â–µ—Å—Ç–≤–∞">–ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª —Å–æ–æ–±—â–µ—Å—Ç–≤–∞</option>
          <option value="–°–ø–∞–º –∏ –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–∞—è —Ä–µ–∫–ª–∞–º–∞">–°–ø–∞–º –∏ –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–∞—è —Ä–µ–∫–ª–∞–º–∞</option>
          <option value="–û—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è –∏ —Ö–∞—Ä–∞—Å—Å–º–µ–Ω—Ç">–û—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è –∏ —Ö–∞—Ä–∞—Å—Å–º–µ–Ω—Ç</option>
          <option value="–ü—É–±–ª–∏–∫–∞—Ü–∏—è –Ω–µ–ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞">–ü—É–±–ª–∏–∫–∞—Ü–∏—è –Ω–µ–ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞</option>
          <option value="–ú–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ –∏–ª–∏ –æ–±–º–∞–Ω">–ú–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ –∏–ª–∏ –æ–±–º–∞–Ω</option>
          <option value="–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è">–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è</option>
          <option value="–ñ–∞–ª–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π">–ñ–∞–ª–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</option>
          <option value="custom">–î—Ä—É–≥–∞—è –ø—Ä–∏—á–∏–Ω–∞ (—É–∫–∞–∑–∞—Ç—å –≤—Ä—É—á–Ω—É—é)</option>
        </select>

        <textarea id="reasonText" name="reason" rows="4" cols="50"
                  placeholder="–£–∫–∞–∂–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω—É—é –ø—Ä–∏—á–∏–Ω—É –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏..."
                  required style="width: 100%; padding: 10px; margin-bottom: 15px;"></textarea>

        <div style="margin-top: 20px;">
          <button type="submit" style="background-color: red; color: white; padding: 15px 30px; font-size: 16px; font-weight: bold;">
            üö´ –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–¢–¨ –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø
          </button>

          <button type="button" onclick="goBack()" style="background-color: gray; color: white; padding: 15px 30px; margin-left: 15px;">
            –û—Ç–º–µ–Ω–∞
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
  <div style="margin-top: 30px; border-top: 1px solid #ccc; padding-top: 20px;">
    <h3>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h3>

    <a th:href="@{'/admin/users/' + ${user.id} + '/history'}" style="text-decoration: none; margin-right: 10px;">
      <button style="background-color: blue; color: white; padding: 10px 20px;">
        üìã –ò—Å—Ç–æ—Ä–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
      </button>
    </a>

    <a href="/admin/users/search" style="text-decoration: none; margin-right: 10px;">
      <button style="background-color: green; color: white; padding: 10px 20px;">
        üîç –ü–æ–∏—Å–∫ –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
      </button>
    </a>

    <a href="/admin/users/blocked" style="text-decoration: none;">
      <button style="background-color: orange; color: white; padding: 10px 20px;">
        üìä –°–ø–∏—Å–æ–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö
      </button>
    </a>
  </div>
</div>

<script>
  function handleReasonChange() {
    const select = document.getElementById('reasonSelect');
    const textarea = document.getElementById('reasonText');

    if (select.value === 'custom') {
      textarea.value = '';
      textarea.placeholder = '–£–∫–∞–∂–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏...';
      textarea.focus();
    } else if (select.value !== '') {
      textarea.value = select.value;
    } else {
      textarea.value = '';
    }
  }

  function confirmBlock() {
    const reason = document.getElementById('reasonText').value.trim();

    if (reason === '') {
      alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏!');
      return false;
    }

    if (reason.length < 10) {
      alert('–ü—Ä–∏—á–∏–Ω–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 10 —Å–∏–º–≤–æ–ª–æ–≤!');
      return false;
    }

    const userEmail = '[[${user.email}]]';
    const userName = '[[${user.firstName}]] [[${user.lastName}]]';

    return confirm(
            '–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?\n\n' +
            '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ' + userName + '\n' +
            'Email: ' + userEmail + '\n' +
            '–ü—Ä–∏—á–∏–Ω–∞: ' + reason + '\n\n' +
            '–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –æ—Ç–º–µ–Ω–∏—Ç—å —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏—é —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏.'
    );
  }

  function goBack() {
    if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—Ç–º–µ–Ω–∏—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É?')) {
      window.history.back();
    }
  }

  // –ê–≤—Ç–æ—Ñ–æ–∫—É—Å –Ω–∞ textarea –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  window.onload = function() {
    const isBlocked = [[${user.isBlocked}]];
    if (!isBlocked) {
      document.getElementById('reasonText').focus();
    }
  };
</script>
</body>
</html>