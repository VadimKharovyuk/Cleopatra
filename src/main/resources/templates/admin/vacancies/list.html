<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏—è–º–∏ - –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</title>
</head>
<body>
<div>
  <header>
    <h1>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏—è–º–∏</h1>
    <nav>
      <a href="/admin">–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</a> |
      <a href="/admin/vacancies">–í—Å–µ –≤–∞–∫–∞–Ω—Å–∏–∏</a> |
      <a href="/admin/vacancies/create">–°–æ–∑–¥–∞—Ç—å –≤–∞–∫–∞–Ω—Å–∏—é</a> |
      <a href="/admin/job-applications">–ó–∞—è–≤–∫–∏</a>
    </nav>
  </header>

  <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
  <div th:if="${successMessage}">
    <p style="color: green;" th:text="${successMessage}">–£—Å–ø–µ—Ö</p>
  </div>
  <div th:if="${errorMessage}">
    <p style="color: red;" th:text="${errorMessage}">–û—à–∏–±–∫–∞</p>
  </div>

  <!-- –§–∏–ª—å—Ç—Ä—ã –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ -->
  <section>
    <h3>–§–∏–ª—å—Ç—Ä—ã –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞</h3>
    <form method="get" action="/admin/vacancies">
      <div>
        <label for="size">–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ:</label>
        <select id="size" name="size">
          <option value="10" th:selected="${vacanciesDto.itemsPerPage == 10}">10</option>
          <option value="25" th:selected="${vacanciesDto.itemsPerPage == 25}">25</option>
          <option value="50" th:selected="${vacanciesDto.itemsPerPage == 50}">50</option>
        </select>

        <label for="sortBy">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:</label>
        <select id="sortBy" name="sortBy">
          <option value="createdAt" th:selected="${currentSortBy == 'createdAt'}">–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è</option>
          <option value="title" th:selected="${currentSortBy == 'title'}">–ù–∞–∑–≤–∞–Ω–∏–µ</option>
          <option value="minSalary" th:selected="${currentSortBy == 'minSalary'}">–ó–∞—Ä–ø–ª–∞—Ç–∞</option>
          <option value="companyName" th:selected="${currentSortBy == 'companyName'}">–ö–æ–º–ø–∞–Ω–∏—è</option>
        </select>

        <label for="sortDir">–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:</label>
        <select id="sortDir" name="sortDir">
          <option value="asc" th:selected="${currentSortDir == 'asc'}">–ü–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é</option>
          <option value="desc" th:selected="${currentSortDir == 'desc'}">–ü–æ —É–±—ã–≤–∞–Ω–∏—é</option>
        </select>

        <button type="submit">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
        <a href="/admin/vacancies">–°–±—Ä–æ—Å–∏—Ç—å</a>
      </div>
    </form>
  </section>

  <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö -->
  <section>
    <p>
      <strong>–°—Ç—Ä–∞–Ω–∏—Ü–∞:</strong> <span th:text="${vacanciesDto.currentPage + 1}">1</span>
      | <strong>–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ:</strong> <span th:text="${vacanciesDto.itemsPerPage}">10</span>
      <span th:if="${vacanciesDto.totalItems != null}">
                | <strong>–í—Å–µ–≥–æ:</strong> <span th:text="${vacanciesDto.totalItems}">0</span> –≤–∞–∫–∞–Ω—Å–∏–π
            </span>
    </p>
  </section>

  <!-- –¢–∞–±–ª–∏—Ü–∞ –≤–∞–∫–∞–Ω—Å–∏–π -->
  <section>
    <div>
      <table border="1">
        <thead>
        <tr>
          <th>ID</th>
          <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
          <th>–ö–æ–º–ø–∞–Ω–∏—è</th>
          <th>–ü—Ä–æ—Ñ–∏–ª—å</th>
          <th>–ó–∞—Ä–ø–ª–∞—Ç–∞</th>
          <th>–ó–∞—è–≤–æ–∫</th>
          <th>–°—Ç–∞—Ç—É—Å</th>
          <th>–î–µ–π—Å—Ç–≤–∏—è</th>
        </tr>
        </thead>
        <tbody>
        <!-- –°—Ç—Ä–æ–∫–∏ –≤–∞–∫–∞–Ω—Å–∏–π -->
        <tr th:each="vacancy : ${vacanciesDto.vacancies}">
          <td th:text="${vacancy.id}">1</td>

          <td>
            <strong th:text="${vacancy.title}">–ù–∞–∑–≤–∞–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–∏</strong>
            <span th:if="${vacancy.isUrgent}" style="color: red;">üî• –°–†–û–ß–ù–û</span>
            <span th:if="${vacancy.isFeatured}" style="color: gold;">‚≠ê –¢–û–ü</span>
          </td>

          <td>
            <img th:if="${vacancy.companyLogoUrl}" th:src="${vacancy.companyLogoUrl}" alt="–õ–æ–≥–æ—Ç–∏–ø" width="30" height="30">
          </td>

          <td>
                        <span th:if="${vacancy.requiredProfile != null}"
                              th:text="${vacancy.requiredProfile.name()}"
                              style="background-color: #e3f2fd; padding: 2px 6px; border-radius: 3px; font-size: 12px;">
                            –ü—Ä–æ—Ñ–∏–ª—å
                        </span>
          </td>

          <td>
                        <span th:if="${vacancy.minSalary != null}">
                            –æ—Ç <span th:text="${vacancy.minSalary}">1000</span>
                            <span th:text="${vacancy.currency}">USD</span>
                        </span>
            <span th:unless="${vacancy.minSalary != null}">–ù–µ —É–∫–∞–∑–∞–Ω–æ</span>
          </td>

          <td>
            <span th:text="${vacancy.applicationsCount ?: 0}">0</span>
          </td>

          <td>
            <span th:text="${vacancy.country}">–°—Ç—Ä–∞–Ω–∞</span>
            <span th:if="${vacancy.city}" th:text="${', ' + vacancy.city}"></span>
          </td>

          <td>
            <a th:href="@{/admin/vacancies/view(id=${vacancy.id})}">üëÅ –ü—Ä–æ—Å–º–æ—Ç—Ä</a> |
            <a th:href="@{/admin/vacancies/edit(id=${vacancy.id})}">‚úè –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a> |
            <form method="post" th:action="@{/admin/vacancies/delete}" style="display: inline;">
              <input type="hidden" name="id" th:value="${vacancy.id}">
              <button type="submit" onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –≤–∞–∫–∞–Ω—Å–∏—é?')"
                      style="background: none; border: none; color: #f44336; cursor: pointer;">
                üóë –£–¥–∞–ª–∏—Ç—å
              </button>
            </form>
          </td>
        </tr>

        <!-- –ï—Å–ª–∏ –Ω–µ—Ç –≤–∞–∫–∞–Ω—Å–∏–π -->
        <tr th:if="${vacanciesDto.vacancies.empty}">
          <td colspan="8" style="text-align: center; padding: 20px; color: #666;">
            –í–∞–∫–∞–Ω—Å–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
            <br><br>
            <a href="/admin/vacancies/create">–°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—É—é –≤–∞–∫–∞–Ω—Å–∏—é</a>
          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </section>

  <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
  <section style="text-align: center; margin: 20px 0;">
    <!-- –ü—Ä–µ–¥—ã–¥—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
    <a th:if="${vacanciesDto.hasPrevious}"
       th:href="@{/admin/vacancies(page=${vacanciesDto.previousPage}, size=${vacanciesDto.itemsPerPage}, sortBy=${currentSortBy}, sortDir=${currentSortDir})}"
       style="padding: 8px 12px; margin: 0 2px; background-color: #f5f5f5; text-decoration: none; border-radius: 4px;">
      ¬´ –ü—Ä–µ–¥—ã–¥—É—â–∞—è
    </a>

    <!-- –¢–µ–∫—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
    <span style="padding: 8px 12px; margin: 0 2px; background-color: #2196f3; color: white; border-radius: 4px;">
            –°—Ç—Ä–∞–Ω–∏—Ü–∞ <span th:text="${vacanciesDto.currentPage + 1}">1</span>
        </span>

    <!-- –°–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
    <a th:if="${vacanciesDto.hasNext}"
       th:href="@{/admin/vacancies(page=${vacanciesDto.nextPage}, size=${vacanciesDto.itemsPerPage}, sortBy=${currentSortBy}, sortDir=${currentSortDir})}"
       style="padding: 8px 12px; margin: 0 2px; background-color: #f5f5f5; text-decoration: none; border-radius: 4px;">
      –°–ª–µ–¥—É—é—â–∞—è ¬ª
    </a>
  </section>

  <footer>
    <p>¬© 2025 Cleopatra Admin Panel</p>
  </footer>
</div>
</body>
</html>